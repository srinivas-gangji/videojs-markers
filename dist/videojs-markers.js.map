{"version":3,"sources":["videojs-markers.js"],"names":["defaultSetting","markerStyle","width","markerTip","display","text","marker","time","breakOverlay","displayTime","overlayText","style","height","color","onMarkerClick","onMarkerReached","index","markers","generateUUID","d","Date","getTime","uuid","replace","c","r","Math","random","floor","toString","getElementBounding","element","elementBounding","defaultBoundingRect","top","bottom","left","right","getBoundingClientRect","e","NULL_INDEX","registerVideoJsMarkersPlugin","options","mergeOptions","isPlain","value","call","constructor","Object","source1","source2","result","sources","forEach","source","keys","key","dom","createEl","tagName","props","attrs","el","Player","prototype","setAttribute","setting","markersMap","markersList","currentMarkerIndex","player","overlayIndex","sortMarkersList","sort","a","b","addMarkers","newMarkers","querySelector","appendChild","createMarkerDiv","push","getPosition","duration","setMarkderDivStyle","markerDiv","className","class","ratio","marginLeft","markerDivBounding","addEventListener","preventDefault","getAttribute","currentTime","registerMarkerTipHandler","updateMarkers","force","markerTime","removeMarkers","indexArray","visibility","deleteIndexList","parentNode","removeChild","reverse","deleteIndex","splice","html","innerHTML","innerText","markerTipBounding","parseFloat","initializeMarkerTip","updateBreakOverlay","initializeOverlay","onTimeUpdate","onUpdateMarker","onTimeUpdateAfterMarkerUpdate","length","getNextMarkerTime","newMarkerIndex","nextMarkerTime","i","initialize","removeAll","on","off","getMarkers","next","prev","add","remove","updateTime","reset","destroy","registerPlugin"],"mappings":";;;;;;;;;;;;;AAAA;;AAEA;;;;;;;;;;;;;;;;AAcA;AACA,MAAMA,iBAAiB;AACrBC,iBAAa;AACXC,aAAO,KADI;AAEX,uBAAiB,KAFN;AAGX,0BAAoB;AAHT,KADQ;AAMrBC,eAAW;AACTC,eAAS,IADA;AAETC,YAAM,cAASC,MAAT,EAAiB;AACrB,eAAO,YAAYA,OAAOD,IAA1B;AACD,OAJQ;AAKTE,YAAM,cAASD,MAAT,EAAiB;AACrB,eAAOA,OAAOC,IAAd;AACD;AAPQ,KANU;AAerBC,kBAAc;AACZJ,eAAS,KADG;AAEZK,mBAAa,CAFD;AAGZJ,YAAM,cAASC,MAAT,EAAiB;AACrB,eAAO,oBAAoBA,OAAOI,WAAlC;AACD,OALW;AAMZC,aAAO;AACLT,eAAO,MADF;AAELU,gBAAQ,KAFH;AAGL,4BAAoB,iBAHf;AAILC,eAAO,OAJF;AAKL,qBAAa;AALR;AANK,KAfO;AA6BrBC,mBAAe,uBAASR,MAAT,EAAiB,CAAE,CA7Bb;AA8BrBS,qBAAiB,yBAAST,MAAT,EAAiBU,KAAjB,EAAwB,CAAE,CA9BtB;AA+BrBC,aAAS;;AAGX;AAlCuB,GAAvB,CAmCA,SAASC,YAAT,GAAgC;AAC9B,QAAIC,IAAI,IAAIC,IAAJ,GAAWC,OAAX,EAAR;AACA,QAAIC,OAAO,uCAAuCC,OAAvC,CAA+C,OAA/C,EAAwD,UAACC,CAAD,EAAO;AACxE,UAAIC,IAAI,CAACN,IAAIO,KAAKC,MAAL,KAAgB,EAArB,IAA2B,EAA3B,GAAgC,CAAxC;AACAR,UAAIO,KAAKE,KAAL,CAAWT,IAAI,EAAf,CAAJ;AACA,aAAO,CAACK,KAAK,GAAL,GAAWC,CAAX,GAAgBA,IAAI,GAAL,GAAY,GAA5B,EAAiCI,QAAjC,CAA0C,EAA1C,CAAP;AACD,KAJU,CAAX;AAKA,WAAOP,IAAP;AACD;;AAED;;;;;;;AAOA,WAASQ,kBAAT,CAA4BC,OAA5B,EAAqC;AACnC,QAAIC,eAAJ;AACA,QAAMC,sBAAsB;AAC1BC,WAAK,CADqB;AAE1BC,cAAQ,CAFkB;AAG1BC,YAAM,CAHoB;AAI1BlC,aAAO,CAJmB;AAK1BU,cAAQ,CALkB;AAM1ByB,aAAO;AANmB,KAA5B;;AASA,QAAI;AACFL,wBAAkBD,QAAQO,qBAAR,EAAlB;AACD,KAFD,CAEE,OAAOC,CAAP,EAAU;AACVP,wBAAkBC,mBAAlB;AACD;;AAED,WAAOD,eAAP;AACD;;AAED,MAAMQ,aAAa,CAAC,CAApB;;AAEA,WAASC,4BAAT,CAAsCC,OAAtC,EAA+C;AAC7C;AACA;AACA,QAAI,CAAC,gBAAQC,YAAb,EAA2B;AAAA,UAChBC,OADgB,GACzB,SAASA,OAAT,CAAiBC,KAAjB,EAAwB;AACtB,eACE,CAAC,CAACA,KAAF,IACA,QAAOA,KAAP,yCAAOA,KAAP,OAAiB,QADjB,IAEAhB,SAASiB,IAAT,CAAcD,KAAd,MAAyB,iBAFzB,IAGAA,MAAME,WAAN,KAAsBC,MAJxB;AAMD,OARwB;;AAAA,UAShBL,YATgB,GASzB,SAASA,YAAT,CAAsBM,OAAtB,EAAuCC,OAAvC,EAAwD;AACtD,YAAMC,SAAS,EAAf;AACA,YAAMC,UAAU,CAACH,OAAD,EAAUC,OAAV,CAAhB;AACAE,gBAAQC,OAAR,CAAgB,UAACC,MAAD,EAAY;AAC1B,cAAI,CAACA,MAAL,EAAa;AACX;AACD;AACDN,iBAAOO,IAAP,CAAYD,MAAZ,EAAoBD,OAApB,CAA4B,UAACG,GAAD,EAAS;AACnC,gBAAIX,QAAQS,OAAOE,GAAP,CAAZ;AACA,gBAAI,CAACZ,QAAQC,KAAR,CAAL,EAAqB;AACnBM,qBAAOK,GAAP,IAAcX,KAAd;AACA;AACD;AACD,gBAAI,CAACD,QAAQO,OAAOK,GAAP,CAAR,CAAL,EAA2B;AACzBL,qBAAOK,GAAP,IAAc,EAAd;AACD;AACDL,mBAAOK,GAAP,IAAcb,aAAaQ,OAAOK,GAAP,CAAb,EAA0BX,KAA1B,CAAd;AACD,WAVD;AAWD,SAfD;AAgBA,eAAOM,MAAP;AACD,OA7BwB;;AA8BzB,sBAAQR,YAAR,GAAuBA,YAAvB;AACD;;AAED,QAAI,CAAC,gBAAQc,GAAR,CAAYC,QAAjB,EAA2B;AACzB,sBAAQD,GAAR,CAAYC,QAAZ,GAAuB,UACrBC,OADqB,EAErBC,KAFqB,EAGrBC,KAHqB,EAIf;AACN,YAAMC,KAAK,gBAAQC,MAAR,CAAeC,SAAf,CAAyBP,GAAzB,CAA6BC,QAA7B,CAAsCC,OAAtC,EAA+CC,KAA/C,CAAX;AACA,YAAI,CAAC,CAACC,KAAN,EAAa;AACXb,iBAAOO,IAAP,CAAYM,KAAZ,EAAmBR,OAAnB,CAA2B,UAACG,GAAD,EAAS;AAClCM,eAAGG,YAAH,CAAgBT,GAAhB,EAAqBK,MAAML,GAAN,CAArB;AACD,WAFD;AAGD;AACD,eAAOM,EAAP;AACD,OAZD;AAaD;;AAED;;;AAGA,QAAII,UAAU,gBAAQvB,YAAR,CAAqB3C,cAArB,EAAqC0C,OAArC,CAAd;AAAA,QACEyB,aAAwC,EAD1C;AAAA,QAEEC,cAA6B,EAF/B;AAAA,QAEmC;AACjCC,yBAAqB7B,UAHvB;AAAA,QAIE8B,SAAS,IAJX;AAAA,QAKEnE,YAAY,IALd;AAAA,QAMEK,eAAe,IANjB;AAAA,QAOE+D,eAAe/B,UAPjB;;AASA,aAASgC,eAAT,GAAiC;AAC/B;AACAJ,kBAAYK,IAAZ,CAAiB,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACzB,eAAOT,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuBmE,CAAvB,IAA4BR,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuBoE,CAAvB,CAAnC;AACD,OAFD;AAGD;;AAED,aAASC,UAAT,CAAoBC,UAApB,EAAqD;AACnDA,iBAAWxB,OAAX,CAAmB,UAAC/C,MAAD,EAAoB;AACrCA,eAAOkD,GAAP,GAAatC,cAAb;;AAEAoD,eACGR,EADH,GAEGgB,aAFH,CAEiB,sBAFjB,EAGGC,WAHH,CAGeC,gBAAgB1E,MAAhB,CAHf;;AAKA;AACA6D,mBAAW7D,OAAOkD,GAAlB,IAAyBlD,MAAzB;AACA8D,oBAAYa,IAAZ,CAAiB3E,MAAjB;AACD,OAXD;;AAaAkE;AACD;;AAED,aAASU,WAAT,CAAqB5E,MAArB,EAA6C;AAC3C,aAAQ4D,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuBD,MAAvB,IAAiCgE,OAAOa,QAAP,EAAlC,GAAuD,GAA9D;AACD;;AAED,aAASC,kBAAT,CAA4B9E,MAA5B,EAA4C+E,SAA5C,EAAqE;AACnEA,gBAAUC,SAAV,oBAAoChF,OAAOiF,KAAP,IAAgB,EAApD;;AAEAvC,aAAOO,IAAP,CAAYW,QAAQjE,WAApB,EAAiCoD,OAAjC,CAAyC,UAACG,GAAD,EAAS;AAChD6B,kBAAU1E,KAAV,CAAgB6C,GAAhB,IAAuBU,QAAQjE,WAAR,CAAoBuD,GAApB,CAAvB;AACD,OAFD;;AAIA;AACA,UAAMgC,QAAQlF,OAAOC,IAAP,GAAc+D,OAAOa,QAAP,EAA5B;AACA,UAAIK,QAAQ,CAAR,IAAaA,QAAQ,CAAzB,EAA4B;AAC1BH,kBAAU1E,KAAV,CAAgBP,OAAhB,GAA0B,MAA1B;AACD;;AAED;AACAiF,gBAAU1E,KAAV,CAAgByB,IAAhB,GAAuB8C,YAAY5E,MAAZ,IAAsB,GAA7C;AACA,UAAIA,OAAO6E,QAAX,EAAqB;AACnBE,kBAAU1E,KAAV,CAAgBT,KAAhB,GAAyBI,OAAO6E,QAAP,GAAkBb,OAAOa,QAAP,EAAnB,GAAwC,GAAxC,GAA8C,GAAtE;AACAE,kBAAU1E,KAAV,CAAgB8E,UAAhB,GAA6B,KAA7B;AACD,OAHD,MAGO;AACL,YAAMC,oBAAoB5D,mBAAmBuD,SAAnB,CAA1B;AACAA,kBAAU1E,KAAV,CAAgB8E,UAAhB,GAA6BC,kBAAkBxF,KAAlB,GAA0B,CAA1B,GAA8B,IAA3D;AACD;AACF;;AAED,aAAS8E,eAAT,CAAyB1E,MAAzB,EAAiD;AAC/C,UAAI+E,YAAY,gBAAQ5B,GAAR,CAAYC,QAAZ,CACd,KADc,EAEd,EAFc,EAGd;AACE,2BAAmBpD,OAAOkD,GAD5B;AAEE,4BAAoBU,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuBD,MAAvB;AAFtB,OAHc,CAAhB;;AASA8E,yBAAmB9E,MAAnB,EAA2B+E,SAA3B;;AAEA;AACAA,gBAAUM,gBAAV,CAA2B,OAA3B,EAAoC,UAASpD,CAAT,EAAY;AAC9C,YAAIqD,iBAAiB,KAArB;AACA,YAAI,OAAO1B,QAAQpD,aAAf,KAAiC,UAArC,EAAiD;AAC/C;AACA8E,2BAAiB1B,QAAQpD,aAAR,CAAsBR,MAAtB,MAAkC,KAAnD;AACD;;AAED,YAAI,CAACsF,cAAL,EAAqB;AACnB,cAAIpC,MAAM,KAAKqC,YAAL,CAAkB,iBAAlB,CAAV;AACAvB,iBAAOwB,WAAP,CAAmB5B,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuB4D,WAAWX,GAAX,CAAvB,CAAnB;AACD;AACF,OAXD;;AAaA,UAAIU,QAAQ/D,SAAR,CAAkBC,OAAtB,EAA+B;AAC7B2F,iCAAyBV,SAAzB;AACD;;AAED,aAAOA,SAAP;AACD;;AAED,aAASW,aAAT,CAAuBC,KAAvB,EAA6C;AAC3C;AACA7B,kBAAYf,OAAZ,CAAoB,UAAC/C,MAAD,EAAoB;AACtC,YAAI+E,YAAYf,OACbR,EADa,GAEbgB,aAFa,CAEC,kCAAkCxE,OAAOkD,GAAzC,GAA+C,IAFhD,CAAhB;AAGA,YAAI0C,aAAahC,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuBD,MAAvB,CAAjB;;AAEA,YAAI2F,SAASZ,UAAUQ,YAAV,CAAuB,kBAAvB,MAA+CK,UAA5D,EAAwE;AACtEd,6BAAmB9E,MAAnB,EAA2B+E,SAA3B;AACAA,oBAAUpB,YAAV,CAAuB,kBAAvB,EAA2CiC,UAA3C;AACD;AACF,OAVD;AAWA1B;AACD;;AAED,aAAS2B,aAAT,CAAuBC,UAAvB,EAAwD;AACtD;AACA,UAAI,CAAC,CAAC5F,YAAN,EAAoB;AAClB+D,uBAAe/B,UAAf;AACAhC,qBAAaG,KAAb,CAAmB0F,UAAnB,GAAgC,QAAhC;AACD;AACDhC,2BAAqB7B,UAArB;;AAEA,UAAI8D,kBAAiC,EAArC;AACAF,iBAAW/C,OAAX,CAAmB,UAACrC,KAAD,EAAmB;AACpC,YAAIV,SAAS8D,YAAYpD,KAAZ,CAAb;AACA,YAAIV,MAAJ,EAAY;AACV;AACA,iBAAO6D,WAAW7D,OAAOkD,GAAlB,CAAP;AACA8C,0BAAgBrB,IAAhB,CAAqBjE,KAArB;;AAEA;AACA,cAAI8C,KAAKQ,OACNR,EADM,GAENgB,aAFM,CAEQ,kCAAkCxE,OAAOkD,GAAzC,GAA+C,IAFvD,CAAT;AAGAM,gBAAMA,GAAGyC,UAAH,CAAcC,WAAd,CAA0B1C,EAA1B,CAAN;AACD;AACF,OAbD;;AAeA;AACAwC,sBAAgBG,OAAhB;AACAH,sBAAgBjD,OAAhB,CAAwB,UAACqD,WAAD,EAAyB;AAC/CtC,oBAAYuC,MAAZ,CAAmBD,WAAnB,EAAgC,CAAhC;AACD,OAFD;;AAIA;AACAlC;AACD;;AAED;AACA,aAASuB,wBAAT,CAAkCV,SAAlC,EAA2D;AACzDA,gBAAUM,gBAAV,CAA2B,WAA3B,EAAwC,YAAM;AAC5C,YAAIrF,SAAS6D,WAAWkB,UAAUQ,YAAV,CAAuB,iBAAvB,CAAX,CAAb;AACA,YAAI,CAAC,CAAC1F,SAAN,EAAiB;AACf,cAAI+D,QAAQ/D,SAAR,CAAkByG,IAAtB,EAA4B;AAC1BzG,sBAAU2E,aAAV,CACE,gBADF,EAEE+B,SAFF,GAEc3C,QAAQ/D,SAAR,CAAkByG,IAAlB,CAAuBtG,MAAvB,CAFd;AAGD,WAJD,MAIO;AACLH,sBAAU2E,aAAV,CACE,gBADF,EAEEgC,SAFF,GAEc5C,QAAQ/D,SAAR,CAAkBE,IAAlB,CAAuBC,MAAvB,CAFd;AAGD;AACD;AACAH,oBAAUQ,KAAV,CAAgByB,IAAhB,GAAuB8C,YAAY5E,MAAZ,IAAsB,GAA7C;AACA,cAAIyG,oBAAoBjF,mBAAmB3B,SAAnB,CAAxB;AACA,cAAIuF,oBAAoB5D,mBAAmBuD,SAAnB,CAAxB;AACAlF,oBAAUQ,KAAV,CAAgB8E,UAAhB,GACE,CAACuB,WAAWD,kBAAkB7G,KAAlB,GAA0B,CAArC,CAAD,GACA8G,WAAWtB,kBAAkBxF,KAAlB,GAA0B,CAArC,CADA,GAEA,IAHF;AAIAC,oBAAUQ,KAAV,CAAgB0F,UAAhB,GAA6B,SAA7B;AACD;AACF,OAtBD;;AAwBAhB,gBAAUM,gBAAV,CAA2B,UAA3B,EAAuC,YAAM;AAC3C,YAAI,CAAC,CAACxF,SAAN,EAAiB;AACfA,oBAAUQ,KAAV,CAAgB0F,UAAhB,GAA6B,QAA7B;AACD;AACF,OAJD;AAKD;;AAED,aAASY,mBAAT,GAAqC;AACnC9G,kBAAY,gBAAQsD,GAAR,CAAYC,QAAZ,CAAqB,KAArB,EAA4B;AACtC4B,mBAAW,SAD2B;AAEtCuB,mBACE;AAHoC,OAA5B,CAAZ;AAKAvC,aACGR,EADH,GAEGgB,aAFH,CAEiB,sBAFjB,EAGGC,WAHH,CAGe5E,SAHf;AAID;;AAED;AACA,aAAS+G,kBAAT,GAAoC;AAClC,UAAI,CAAChD,QAAQ1D,YAAR,CAAqBJ,OAAtB,IAAiCiE,qBAAqB,CAA1D,EAA6D;AAC3D;AACD;;AAED,UAAIyB,cAAcxB,OAAOwB,WAAP,EAAlB;AACA,UAAIxF,SAAS8D,YAAYC,kBAAZ,CAAb;AACA,UAAI6B,aAAahC,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuBD,MAAvB,CAAjB;;AAEA,UACEwF,eAAeI,UAAf,IACAJ,eAAeI,aAAahC,QAAQ1D,YAAR,CAAqBC,WAFnD,EAGE;AACA,YAAI8D,iBAAiBF,kBAArB,EAAyC;AACvCE,yBAAeF,kBAAf;AACA,cAAI7D,YAAJ,EAAkB;AAChBA,yBAAasE,aAAb,CACE,yBADF,EAEE+B,SAFF,GAEc3C,QAAQ1D,YAAR,CAAqBH,IAArB,CAA0BC,MAA1B,CAFd;AAGD;AACF;;AAED,YAAIE,YAAJ,EAAkB;AAChBA,uBAAaG,KAAb,CAAmB0F,UAAnB,GAAgC,SAAhC;AACD;AACF,OAhBD,MAgBO;AACL9B,uBAAe/B,UAAf;AACA,YAAIhC,YAAJ,EAAkB;AAChBA,uBAAaG,KAAb,CAAmB0F,UAAnB,GAAgC,QAAhC;AACD;AACF;AACF;;AAED;AACA,aAASc,iBAAT,GAAmC;AACjC3G,qBAAe,gBAAQiD,GAAR,CAAYC,QAAZ,CAAqB,KAArB,EAA4B;AACzC4B,mBAAW,mBAD8B;AAEzCuB,mBAAW;AAF8B,OAA5B,CAAf;AAIA7D,aAAOO,IAAP,CAAYW,QAAQ1D,YAAR,CAAqBG,KAAjC,EAAwC0C,OAAxC,CAAgD,UAACG,GAAD,EAAS;AACvD,YAAIhD,YAAJ,EAAkB;AAChBA,uBAAaG,KAAb,CAAmB6C,GAAnB,IAA0BU,QAAQ1D,YAAR,CAAqBG,KAArB,CAA2B6C,GAA3B,CAA1B;AACD;AACF,OAJD;AAKAc,aAAOR,EAAP,GAAYiB,WAAZ,CAAwBvE,YAAxB;AACA+D,qBAAe/B,UAAf;AACD;;AAED,aAAS4E,YAAT,GAA8B;AAC5BC;AACAH;AACAxE,cAAQ4E,6BAAR,IACE5E,QAAQ4E,6BAAR,EADF;AAED;;AAED,aAASD,cAAT,GAA0B;AACxB;;;;;AAKA,UAAI,CAACjD,YAAYmD,MAAjB,EAAyB;AACvB;AACD;;AAED,UAAIC,oBAAoB,SAApBA,iBAAoB,CAACxG,KAAD,EAAmB;AACzC,YAAIA,QAAQoD,YAAYmD,MAAZ,GAAqB,CAAjC,EAAoC;AAClC,iBAAOrD,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuB6D,YAAYpD,QAAQ,CAApB,CAAvB,CAAP;AACD;AACD;AACA,eAAOsD,OAAOa,QAAP,EAAP;AACD,OAND;AAOA,UAAIW,cAAcxB,OAAOwB,WAAP,EAAlB;AACA,UAAI2B,iBAAiBjF,UAArB;;AAEA,UAAI6B,uBAAuB7B,UAA3B,EAAuC;AACrC;AACA,YAAIkF,iBAAiBF,kBAAkBnD,kBAAlB,CAArB;AACA,YACEyB,eACE5B,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuB6D,YAAYC,kBAAZ,CAAvB,CADF,IAEAyB,cAAc4B,cAHhB,EAIE;AACA;AACD;;AAED;AACA,YACErD,uBAAuBD,YAAYmD,MAAZ,GAAqB,CAA5C,IACAzB,gBAAgBxB,OAAOa,QAAP,EAFlB,EAGE;AACA;AACD;AACF;;AAED;AACA,UAAIW,cAAc5B,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuB6D,YAAY,CAAZ,CAAvB,CAAlB,EAA0D;AACxDqD,yBAAiBjF,UAAjB;AACD,OAFD,MAEO;AACL;AACA,aAAK,IAAImF,IAAI,CAAb,EAAgBA,IAAIvD,YAAYmD,MAAhC,EAAwCI,GAAxC,EAA6C;AAC3CD,2BAAiBF,kBAAkBG,CAAlB,CAAjB;AACA,cACE7B,eAAe5B,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuB6D,YAAYuD,CAAZ,CAAvB,CAAf,IACA7B,cAAc4B,cAFhB,EAGE;AACAD,6BAAiBE,CAAjB;AACA;AACD;AACF;AACF;;AAED;AACA,UAAIF,mBAAmBpD,kBAAvB,EAA2C;AACzC;AACA,YAAIoD,mBAAmBjF,UAAnB,IAAiCE,QAAQ3B,eAA7C,EAA8D;AAC5D2B,kBAAQ3B,eAAR,CAAwBqD,YAAYqD,cAAZ,CAAxB,EAAqDA,cAArD;AACD;AACDpD,6BAAqBoD,cAArB;AACD;AACF;;AAED;AACA,aAASG,UAAT,GAA4B;AAC1B,UAAI1D,QAAQ/D,SAAR,CAAkBC,OAAtB,EAA+B;AAC7B6G;AACD;;AAED;AACA3C,aAAOrD,OAAP,CAAe4G,SAAf;AACAjD,iBAAWV,QAAQjD,OAAnB;;AAEA,UAAIiD,QAAQ1D,YAAR,CAAqBJ,OAAzB,EAAkC;AAChC+G;AACD;AACDC;AACA9C,aAAOwD,EAAP,CAAU,YAAV,EAAwBV,YAAxB;AACA9C,aAAOyD,GAAP,CAAW,gBAAX;AACD;;AAED;AACAzD,WAAOwD,EAAP,CAAU,gBAAV,EAA4B,YAAW;AACrCF;AACD,KAFD;;AAIA;AACAtD,WAAOrD,OAAP,GAAiB;AACf+G,kBAAY,sBAA0B;AACpC,eAAO5D,WAAP;AACD,OAHc;AAIf6D,YAAM,gBAAiB;AACrB;AACA,YAAMnC,cAAcxB,OAAOwB,WAAP,EAApB;AACA,aAAK,IAAI6B,IAAI,CAAb,EAAgBA,IAAIvD,YAAYmD,MAAhC,EAAwCI,GAAxC,EAA6C;AAC3C,cAAIzB,aAAahC,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuB6D,YAAYuD,CAAZ,CAAvB,CAAjB;AACA,cAAIzB,aAAaJ,WAAjB,EAA8B;AAC5BxB,mBAAOwB,WAAP,CAAmBI,UAAnB;AACA;AACD;AACF;AACF,OAdc;AAefgC,YAAM,gBAAiB;AACrB;AACA,YAAMpC,cAAcxB,OAAOwB,WAAP,EAApB;AACA,aAAK,IAAI6B,IAAIvD,YAAYmD,MAAZ,GAAqB,CAAlC,EAAqCI,KAAK,CAA1C,EAA6CA,GAA7C,EAAkD;AAChD,cAAIzB,aAAahC,QAAQ/D,SAAR,CAAkBI,IAAlB,CAAuB6D,YAAYuD,CAAZ,CAAvB,CAAjB;AACA;AACA,cAAIzB,aAAa,GAAb,GAAmBJ,WAAvB,EAAoC;AAClCxB,mBAAOwB,WAAP,CAAmBI,UAAnB;AACA;AACD;AACF;AACF,OA1Bc;AA2BfiC,WAAK,aAAStD,UAAT,EAA0C;AAC7C;AACAD,mBAAWC,UAAX;AACD,OA9Bc;AA+BfuD,cAAQ,gBAAShC,UAAT,EAA0C;AAChD;AACAD,sBAAcC,UAAd;AACD,OAlCc;AAmCfyB,iBAAW,qBAAiB;AAC1B,YAAIzB,aAAa,EAAjB;AACA,aAAK,IAAIuB,IAAI,CAAb,EAAgBA,IAAIvD,YAAYmD,MAAhC,EAAwCI,GAAxC,EAA6C;AAC3CvB,qBAAWnB,IAAX,CAAgB0C,CAAhB;AACD;AACDxB,sBAAcC,UAAd;AACD,OAzCc;AA0Cf;AACAiC,kBAAY,oBAASpC,KAAT,EAA+B;AACzC;AACAD,sBAAcC,KAAd;AACD,OA9Cc;AA+CfqC,aAAO,eAASzD,UAAT,EAA0C;AAC/C;AACAP,eAAOrD,OAAP,CAAe4G,SAAf;AACAjD,mBAAWC,UAAX;AACD,OAnDc;AAoDf0D,eAAS,mBAAiB;AACxB;AACAjE,eAAOrD,OAAP,CAAe4G,SAAf;AACArH,wBAAgBA,aAAa4H,MAAb,EAAhB;AACAjI,qBAAaA,UAAUiI,MAAV,EAAb;AACA9D,eAAOyD,GAAP,CAAW,YAAX,EAAyBb,kBAAzB;AACA,eAAO5C,OAAOrD,OAAd;AACD;AA3Dc,KAAjB;AA6DD;;AAED,kBAAQuH,cAAR,CAAuB,SAAvB,EAAkC/F,4BAAlC","file":"videojs-markers.js","sourcesContent":["/*! videojs-markers - v1.0.1 - 2019-03-09\n* Copyright (c) 2019 ; Licensed  */\n\"use strict\"\n\nimport videojs from \"video.js\"\n\ntype Marker = {\n  time: number,\n  duration: number,\n  text?: string,\n  class?: string,\n  overlayText?: string,\n  // private property\n  key: string\n}\n\n// default setting\nconst defaultSetting = {\n  markerStyle: {\n    width: \"7px\",\n    \"border-radius\": \"30%\",\n    \"background-color\": \"red\"\n  },\n  markerTip: {\n    display: true,\n    text: function(marker) {\n      return \"Break: \" + marker.text\n    },\n    time: function(marker) {\n      return marker.time\n    }\n  },\n  breakOverlay: {\n    display: false,\n    displayTime: 3,\n    text: function(marker) {\n      return \"Break overlay: \" + marker.overlayText\n    },\n    style: {\n      width: \"100%\",\n      height: \"20%\",\n      \"background-color\": \"rgba(0,0,0,0.7)\",\n      color: \"white\",\n      \"font-size\": \"17px\"\n    }\n  },\n  onMarkerClick: function(marker) {},\n  onMarkerReached: function(marker, index) {},\n  markers: []\n}\n\n// create a non-colliding random number\nfunction generateUUID(): string {\n  var d = new Date().getTime()\n  var uuid = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, (c) => {\n    var r = (d + Math.random() * 16) % 16 | 0\n    d = Math.floor(d / 16)\n    return (c == \"x\" ? r : (r & 0x3) | 0x8).toString(16)\n  })\n  return uuid\n}\n\n/**\n * Returns the size of an element and its position\n * a default Object with 0 on each of its properties\n * its return in case there's an error\n * @param  {Element} element  el to get the size and position\n * @return {DOMRect|Object}   size and position of an element\n */\nfunction getElementBounding(element) {\n  var elementBounding\n  const defaultBoundingRect = {\n    top: 0,\n    bottom: 0,\n    left: 0,\n    width: 0,\n    height: 0,\n    right: 0\n  }\n\n  try {\n    elementBounding = element.getBoundingClientRect()\n  } catch (e) {\n    elementBounding = defaultBoundingRect\n  }\n\n  return elementBounding\n}\n\nconst NULL_INDEX = -1\n\nfunction registerVideoJsMarkersPlugin(options) {\n  // copied from video.js/src/js/utils/merge-options.js since\n  // videojs 4 doens't support it by defualt.\n  if (!videojs.mergeOptions) {\n    function isPlain(value) {\n      return (\n        !!value &&\n        typeof value === \"object\" &&\n        toString.call(value) === \"[object Object]\" &&\n        value.constructor === Object\n      )\n    }\n    function mergeOptions(source1: Object, source2: Object) {\n      const result = {}\n      const sources = [source1, source2]\n      sources.forEach((source) => {\n        if (!source) {\n          return\n        }\n        Object.keys(source).forEach((key) => {\n          let value = source[key]\n          if (!isPlain(value)) {\n            result[key] = value\n            return\n          }\n          if (!isPlain(result[key])) {\n            result[key] = {}\n          }\n          result[key] = mergeOptions(result[key], value)\n        })\n      })\n      return result\n    }\n    videojs.mergeOptions = mergeOptions\n  }\n\n  if (!videojs.dom.createEl) {\n    videojs.dom.createEl = function(\n      tagName: string,\n      props: Object,\n      attrs?: Object\n    ): void {\n      const el = videojs.Player.prototype.dom.createEl(tagName, props)\n      if (!!attrs) {\n        Object.keys(attrs).forEach((key) => {\n          el.setAttribute(key, attrs[key])\n        })\n      }\n      return el\n    }\n  }\n\n  /**\n   * register the markers plugin (dependent on jquery)\n   */\n  let setting = videojs.mergeOptions(defaultSetting, options),\n    markersMap: { [key: string]: Marker } = {},\n    markersList: Array<Marker> = [], // list of markers sorted by time\n    currentMarkerIndex = NULL_INDEX,\n    player = this,\n    markerTip = null,\n    breakOverlay = null,\n    overlayIndex = NULL_INDEX\n\n  function sortMarkersList(): void {\n    // sort the list by time in asc order\n    markersList.sort((a, b) => {\n      return setting.markerTip.time(a) - setting.markerTip.time(b)\n    })\n  }\n\n  function addMarkers(newMarkers: Array<Marker>): void {\n    newMarkers.forEach((marker: Marker) => {\n      marker.key = generateUUID()\n\n      player\n        .el()\n        .querySelector(\".vjs-progress-holder\")\n        .appendChild(createMarkerDiv(marker))\n\n      // store marker in an internal hash map\n      markersMap[marker.key] = marker\n      markersList.push(marker)\n    })\n\n    sortMarkersList()\n  }\n\n  function getPosition(marker: Marker): number {\n    return (setting.markerTip.time(marker) / player.duration()) * 100\n  }\n\n  function setMarkderDivStyle(marker: Marker, markerDiv: Object): void {\n    markerDiv.className = `vjs-marker ${marker.class || \"\"}`\n\n    Object.keys(setting.markerStyle).forEach((key) => {\n      markerDiv.style[key] = setting.markerStyle[key]\n    })\n\n    // hide out-of-bound markers\n    const ratio = marker.time / player.duration()\n    if (ratio < 0 || ratio > 1) {\n      markerDiv.style.display = \"none\"\n    }\n\n    // set position\n    markerDiv.style.left = getPosition(marker) + \"%\"\n    if (marker.duration) {\n      markerDiv.style.width = (marker.duration / player.duration()) * 100 + \"%\"\n      markerDiv.style.marginLeft = \"0px\"\n    } else {\n      const markerDivBounding = getElementBounding(markerDiv)\n      markerDiv.style.marginLeft = markerDivBounding.width / 2 + \"px\"\n    }\n  }\n\n  function createMarkerDiv(marker: Marker): Object {\n    var markerDiv = videojs.dom.createEl(\n      \"div\",\n      {},\n      {\n        \"data-marker-key\": marker.key,\n        \"data-marker-time\": setting.markerTip.time(marker)\n      }\n    )\n\n    setMarkderDivStyle(marker, markerDiv)\n\n    // bind click event to seek to marker time\n    markerDiv.addEventListener(\"click\", function(e) {\n      var preventDefault = false\n      if (typeof setting.onMarkerClick === \"function\") {\n        // if return false, prevent default behavior\n        preventDefault = setting.onMarkerClick(marker) === false\n      }\n\n      if (!preventDefault) {\n        var key = this.getAttribute(\"data-marker-key\")\n        player.currentTime(setting.markerTip.time(markersMap[key]))\n      }\n    })\n\n    if (setting.markerTip.display) {\n      registerMarkerTipHandler(markerDiv)\n    }\n\n    return markerDiv\n  }\n\n  function updateMarkers(force: boolean): void {\n    // update UI for markers whose time changed\n    markersList.forEach((marker: Marker) => {\n      var markerDiv = player\n        .el()\n        .querySelector(\".vjs-marker[data-marker-key='\" + marker.key + \"']\")\n      var markerTime = setting.markerTip.time(marker)\n\n      if (force || markerDiv.getAttribute(\"data-marker-time\") !== markerTime) {\n        setMarkderDivStyle(marker, markerDiv)\n        markerDiv.setAttribute(\"data-marker-time\", markerTime)\n      }\n    })\n    sortMarkersList()\n  }\n\n  function removeMarkers(indexArray: Array<number>): void {\n    // reset overlay\n    if (!!breakOverlay) {\n      overlayIndex = NULL_INDEX\n      breakOverlay.style.visibility = \"hidden\"\n    }\n    currentMarkerIndex = NULL_INDEX\n\n    let deleteIndexList: Array<number> = []\n    indexArray.forEach((index: number) => {\n      let marker = markersList[index]\n      if (marker) {\n        // delete from memory\n        delete markersMap[marker.key]\n        deleteIndexList.push(index)\n\n        // delete from dom\n        let el = player\n          .el()\n          .querySelector(\".vjs-marker[data-marker-key='\" + marker.key + \"']\")\n        el && el.parentNode.removeChild(el)\n      }\n    })\n\n    // clean up markers array\n    deleteIndexList.reverse()\n    deleteIndexList.forEach((deleteIndex: number) => {\n      markersList.splice(deleteIndex, 1)\n    })\n\n    // sort again\n    sortMarkersList()\n  }\n\n  // attach hover event handler\n  function registerMarkerTipHandler(markerDiv: Object): void {\n    markerDiv.addEventListener(\"mouseover\", () => {\n      var marker = markersMap[markerDiv.getAttribute(\"data-marker-key\")]\n      if (!!markerTip) {\n        if (setting.markerTip.html) {\n          markerTip.querySelector(\n            \".vjs-tip-inner\"\n          ).innerHTML = setting.markerTip.html(marker)\n        } else {\n          markerTip.querySelector(\n            \".vjs-tip-inner\"\n          ).innerText = setting.markerTip.text(marker)\n        }\n        // margin-left needs to minus the padding length to align correctly with the marker\n        markerTip.style.left = getPosition(marker) + \"%\"\n        var markerTipBounding = getElementBounding(markerTip)\n        var markerDivBounding = getElementBounding(markerDiv)\n        markerTip.style.marginLeft =\n          -parseFloat(markerTipBounding.width / 2) +\n          parseFloat(markerDivBounding.width / 4) +\n          \"px\"\n        markerTip.style.visibility = \"visible\"\n      }\n    })\n\n    markerDiv.addEventListener(\"mouseout\", () => {\n      if (!!markerTip) {\n        markerTip.style.visibility = \"hidden\"\n      }\n    })\n  }\n\n  function initializeMarkerTip(): void {\n    markerTip = videojs.dom.createEl(\"div\", {\n      className: \"vjs-tip\",\n      innerHTML:\n        \"<div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div>\"\n    })\n    player\n      .el()\n      .querySelector(\".vjs-progress-holder\")\n      .appendChild(markerTip)\n  }\n\n  // show or hide break overlays\n  function updateBreakOverlay(): void {\n    if (!setting.breakOverlay.display || currentMarkerIndex < 0) {\n      return\n    }\n\n    var currentTime = player.currentTime()\n    var marker = markersList[currentMarkerIndex]\n    var markerTime = setting.markerTip.time(marker)\n\n    if (\n      currentTime >= markerTime &&\n      currentTime <= markerTime + setting.breakOverlay.displayTime\n    ) {\n      if (overlayIndex !== currentMarkerIndex) {\n        overlayIndex = currentMarkerIndex\n        if (breakOverlay) {\n          breakOverlay.querySelector(\n            \".vjs-break-overlay-text\"\n          ).innerHTML = setting.breakOverlay.text(marker)\n        }\n      }\n\n      if (breakOverlay) {\n        breakOverlay.style.visibility = \"visible\"\n      }\n    } else {\n      overlayIndex = NULL_INDEX\n      if (breakOverlay) {\n        breakOverlay.style.visibility = \"hidden\"\n      }\n    }\n  }\n\n  // problem when the next marker is within the overlay display time from the previous marker\n  function initializeOverlay(): void {\n    breakOverlay = videojs.dom.createEl(\"div\", {\n      className: \"vjs-break-overlay\",\n      innerHTML: \"<div class='vjs-break-overlay-text'></div>\"\n    })\n    Object.keys(setting.breakOverlay.style).forEach((key) => {\n      if (breakOverlay) {\n        breakOverlay.style[key] = setting.breakOverlay.style[key]\n      }\n    })\n    player.el().appendChild(breakOverlay)\n    overlayIndex = NULL_INDEX\n  }\n\n  function onTimeUpdate(): void {\n    onUpdateMarker()\n    updateBreakOverlay()\n    options.onTimeUpdateAfterMarkerUpdate &&\n      options.onTimeUpdateAfterMarkerUpdate()\n  }\n\n  function onUpdateMarker() {\n    /*\n      check marker reached in between markers\n      the logic here is that it triggers a new marker reached event only if the player\n      enters a new marker range (e.g. from marker 1 to marker 2). Thus, if player is on marker 1 and user clicked on marker 1 again, no new reached event is triggered)\n    */\n    if (!markersList.length) {\n      return\n    }\n\n    var getNextMarkerTime = (index: number) => {\n      if (index < markersList.length - 1) {\n        return setting.markerTip.time(markersList[index + 1])\n      }\n      // next marker time of last marker would be end of video time\n      return player.duration()\n    }\n    var currentTime = player.currentTime()\n    var newMarkerIndex = NULL_INDEX\n\n    if (currentMarkerIndex !== NULL_INDEX) {\n      // check if staying at same marker\n      var nextMarkerTime = getNextMarkerTime(currentMarkerIndex)\n      if (\n        currentTime >=\n          setting.markerTip.time(markersList[currentMarkerIndex]) &&\n        currentTime < nextMarkerTime\n      ) {\n        return\n      }\n\n      // check for ending (at the end current time equals player duration)\n      if (\n        currentMarkerIndex === markersList.length - 1 &&\n        currentTime === player.duration()\n      ) {\n        return\n      }\n    }\n\n    // check first marker, no marker is selected\n    if (currentTime < setting.markerTip.time(markersList[0])) {\n      newMarkerIndex = NULL_INDEX\n    } else {\n      // look for new index\n      for (var i = 0; i < markersList.length; i++) {\n        nextMarkerTime = getNextMarkerTime(i)\n        if (\n          currentTime >= setting.markerTip.time(markersList[i]) &&\n          currentTime < nextMarkerTime\n        ) {\n          newMarkerIndex = i\n          break\n        }\n      }\n    }\n\n    // set new marker index\n    if (newMarkerIndex !== currentMarkerIndex) {\n      // trigger event if index is not null\n      if (newMarkerIndex !== NULL_INDEX && options.onMarkerReached) {\n        options.onMarkerReached(markersList[newMarkerIndex], newMarkerIndex)\n      }\n      currentMarkerIndex = newMarkerIndex\n    }\n  }\n\n  // setup the whole thing\n  function initialize(): void {\n    if (setting.markerTip.display) {\n      initializeMarkerTip()\n    }\n\n    // remove existing markers if already initialized\n    player.markers.removeAll()\n    addMarkers(setting.markers)\n\n    if (setting.breakOverlay.display) {\n      initializeOverlay()\n    }\n    onTimeUpdate()\n    player.on(\"timeupdate\", onTimeUpdate)\n    player.off(\"loadedmetadata\")\n  }\n\n  // setup the plugin after we loaded video's meta data\n  player.on(\"loadedmetadata\", function() {\n    initialize()\n  })\n\n  // exposed plugin API\n  player.markers = {\n    getMarkers: function(): Array<Marker> {\n      return markersList\n    },\n    next: function(): void {\n      // go to the next marker from current timestamp\n      const currentTime = player.currentTime()\n      for (var i = 0; i < markersList.length; i++) {\n        var markerTime = setting.markerTip.time(markersList[i])\n        if (markerTime > currentTime) {\n          player.currentTime(markerTime)\n          break\n        }\n      }\n    },\n    prev: function(): void {\n      // go to previous marker\n      const currentTime = player.currentTime()\n      for (var i = markersList.length - 1; i >= 0; i--) {\n        var markerTime = setting.markerTip.time(markersList[i])\n        // add a threshold\n        if (markerTime + 0.5 < currentTime) {\n          player.currentTime(markerTime)\n          return\n        }\n      }\n    },\n    add: function(newMarkers: Array<Marker>): void {\n      // add new markers given an array of index\n      addMarkers(newMarkers)\n    },\n    remove: function(indexArray: Array<number>): void {\n      // remove markers given an array of index\n      removeMarkers(indexArray)\n    },\n    removeAll: function(): void {\n      var indexArray = []\n      for (var i = 0; i < markersList.length; i++) {\n        indexArray.push(i)\n      }\n      removeMarkers(indexArray)\n    },\n    // force - force all markers to be updated, regardless of if they have changed or not.\n    updateTime: function(force: boolean): void {\n      // notify the plugin to update the UI for changes in marker times\n      updateMarkers(force)\n    },\n    reset: function(newMarkers: Array<Marker>): void {\n      // remove all the existing markers and add new ones\n      player.markers.removeAll()\n      addMarkers(newMarkers)\n    },\n    destroy: function(): void {\n      // unregister the plugins and clean up even handlers\n      player.markers.removeAll()\n      breakOverlay && breakOverlay.remove()\n      markerTip && markerTip.remove()\n      player.off(\"timeupdate\", updateBreakOverlay)\n      delete player.markers\n    }\n  }\n}\n\nvideojs.registerPlugin(\"markers\", registerVideoJsMarkersPlugin)\n"]}